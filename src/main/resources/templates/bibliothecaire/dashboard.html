<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <title>Tableau de bord Bibliothécaire</title>
    <link rel="stylesheet" th:href="@{/css/style.css}">
</head>
<body>
    <h1>Tableau de bord Bibliothécaire</h1>

    <div>
        <a th:href="@{/bibliothecaire/ajouter-livre}">Ajouter un livre</a>
        <a th:href="@{/bibliothecaire/ajouter-adherent}">Ajouter un adhérent</a>
        <a th:href="@{/bibliothecaire/emprunter-livre}">Emprunter un livre</a>
        <a th:href="@{/bibliothecaire/reserver-livre}">Réserver un livre</a>
    </div>

    <div>
        <h2>Livres</h2>
        <table>
            <tr>
                <th>Titre</th><th>Auteur</th><th>ISBN</th><th>Exemplaires</th><th>Âge minimum</th><th>Disponible</th>
            </tr>
            <tr th:each="livre : ${livres}">
                <td th:text="${livre.titre}"></td>
                <td th:text="${livre.auteur}"></td>
                <td th:text="${livre.isbn}"></td>
                <td th:text="${livre.nombreExemplaires}"></td>
                <td th:text="${livre.ageMinimum}"></td>
                <td th:text="${livre.disponible ? 'Oui' : 'Non'}"></td>
            </tr>
        </table>
    </div>

    <div>
        <h2>Adhérents</h2>
        <table>
            <tr>
                <th>Nom</th><th>Email</th><th>Âge</th><th>Catégorie</th><th>Quota Prêt</th><th>Quota Réservation</th>
            </tr>
            <tr th:each="adherent : ${adherents}">
                <td th:text="${adherent.nom}"></td>
                <td th:text="${adherent.email}"></td>
                <td th:text="${adherent.age}"></td>
                <td th:text="${adherent.categorie}"></td>
                <td th:text="${adherent.quotaPret}"></td>
                <td th:text="${adherent.quotaReservation}"></td>
            </tr>
        </table>
    </div>

    <div>
        <h2>Prêts en cours</h2>
        <table>
            <tr>
                <th>Adhérent</th><th>Livre</th><th>Date emprunt</th><th>Date retour</th><th>Actions</th>
            </tr>
            <tr th:each="pret : ${prets}">
                <td th:text="${pret.adherent.nom}"></td>
                <td th:text="${pret.livre.titre}"></td>
                <td th:text="${#temporals.format(pret.dateEmprunt, 'dd/MM/yyyy')}"></td>
                <td th:text="${#temporals.format(pret.dateRetourPrevus, 'dd/MM/yyyy')}"></td>
                <td>
                    <a th:href="@{'/bibliothecaire/prolonger-pret/' + ${pret.id}}">Prolonger</a>
                    <a th:href="@{'/bibliothecaire/retourner-livre/' + ${pret.id}}">Retourner</a>
                </td>
            </tr>
        </table>
    </div>

    <div>
        <h2>Réservations</h2>
        <table>
            <tr>
                <th>Adhérent</th><th>Livre</th><th>Date réservation</th><th>Date limite</th>
            </tr>
            <tr th:each="reservation : ${reservations}">
                <td th:text="${reservation.adherent.nom}"></td>
                <td th:text="${reservation.livre.titre}"></td>
                <td th:text="${#temporals.format(reservation.dateReservation, 'dd/MM/yyyy')}"></td>
                <td th:text="${#temporals.format(reservation.dateLimiteRetrait, 'dd/MM/yyyy')}"></td>
            </tr>
        </table>
    </div>

    <div>
        <h2>Demandes en attente</h2>
        <table>
            <tr>
                <th>Adhérent</th><th>Livre</th><th>Type</th><th>Date soumission</th><th>Date retrait</th><th>Type prêt</th><th>Actions</th>
            </tr>
            <tr th:each="demande : ${demandes}">
                <td th:text="${demande.adherent.nom}"></td>
                <td th:text="${demande.livre.titre}"></td>
                <td th:text="${demande.typeDemande}"></td>
                <td th:text="${#temporals.format(demande.dateSoumission, 'dd/MM/yyyy')}"></td>
                <td th:text="${demande.dateRetraitSouhaitee != null ? #temporals.format(demande.dateRetraitSouhaitee, 'dd/MM/yyyy') : '-'}"></td>
                <td th:text="${demande.typePret != null ? demande.typePret : '-'}"></td>
                <td>
                    <a th:href="@{'/bibliothecaire/valider-demande/' + ${demande.id}}">Valider</a>
                    <a th:href="@{'/bibliothecaire/rejeter-demande/' + ${demande.id}}">Rejeter</a>
                </td>
            </tr>
        </table>
    </div>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'959e42b88ca2b3fd',t:'MTc1MTYyODMxMi4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>